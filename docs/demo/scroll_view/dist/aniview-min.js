!function(e,t){if("function"==typeof define)define.amd?define(["jQuery"],function(){return t(jQuery)}):define(function(e,n,o){var i=e("jQuery");o.exports=t(i)});else{if("object"!=typeof module||!module.exports)return t(e),e;module.exports=t(e)}}(jQuery,function(e){"use strict";function t(){if(m&&m[0].document!==window.document){var e=m.offset();return{top:m.scrollTop()+e.top,left:m.scrollLeft()+e.left}}return{top:m.scrollTop(),left:m[0].pageXOffset}}function n(){return t().top<=10}function o(){var e,n,o=t();return m&&m[0].document!==window.document?(e=window.document.documentElement.offsetHeight,n=window.document.documentElement.clientHeight):(e=m[0].offsetHeight+m[0].scrollTop,n=m[0].clientHeight),o.top+n>=e-10}function i(t,n){for(var o,i,r=Math.abs(n-t),f=0,l=!0,s=0;s<d.length;s++)if(c(d[s],!0)&&(o=e(d[s].ele),i=a(o[0]).top+o.height()*d[s].viewPercent,f=Math.abs(i-t),r>f)){l=!1;break}return l}function a(e){for(var t=e.offsetTop,n=e.offsetLeft;e.offsetParent;)e=e.offsetParent,isNaN(e.offsetTop)||(t+=e.offsetTop),isNaN(e.offsetLeft)||(n+=e.offsetLeft);return{top:t,left:n}}function c(c,r){var f=e(c.ele),l=c.viewPercent,s=t(),u=s.top,d=s.left,v=u+m.height(),h=d+m.width(),b=a(f[0]),w=b.top+f.height()*l,k=b.left+f.width()*l,g=b.top+(1-l)*f.height(),y=b.left+(1-l)*f.width(),C=w<=v&&g>=u&&k>=d&&y<=h;return!r&&C&&p&&(C=n()?i(u,w):(o(),i(v,w))),C}function r(e){return!c(e)&&e.blocked&&e.active}function f(e){return c(e)&&!e.blocked&&!e.active}function l(){e.each(d,function(e,t){t&&(f(t)?u.animate(t,!0):v&&r(t)&&u.animate(t,!1))})}function s(t){var n=e.extend({},h,t);this.options=n,m=n.container||e(window),v=n.loop,p=void 0!==n.nearest&&n.nearest,this.init(),m.on("scroll",function(){l()})}var u=void 0,d=[],m=void 0,p=!1,v=!1,h={container:"",delay:200,aniClass:".ani",loop:!1,viewPercent:.2,animateCallback:function(){},resetCallback:function(){}};s.prototype.init=function(){var t=this,n=t.options,o=n.aniClass;e(o).each(function(t,o){d.push({ele:o,viewPercent:n.viewPercent,active:!1,blocked:!1,animation:e(o).data("viewAnimation"),callback:{starter:void 0,timer:void 0}})})},s.prototype.animate=function(t,n){var o=this,i=o.options,a=0;if(n){if(t.blocked)return!1;t.active=!0,t.blocked=!0,e(t.ele).addClass("active"),t.animation&&e(t.ele).addClass(t.animation),"function"==typeof i.animateCallback&&i.animateCallback(t)}else{if(!t.blocked)return!1;t.active=!1,t.blocked=!1,t.callback.timer?(a=(new Date).getTime()-t.callback.starter,clearTimeout(t.callback.timer)):t.callback.starter=(new Date).getTime(),t.callback.timer=setTimeout(function(){e(t.ele).removeClass("active"),t.animation&&e(t.ele).removeClass(t.animation),"function"==typeof i.resetCallback&&i.resetCallback(t),t.callback.timer=void 0},Math.abs(i.delay-a))}},e.extend({aniView:function(e){u||(u=new s(e),l())}})});